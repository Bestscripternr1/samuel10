local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/1nig1htmare1234/SCRIPTS/refs/heads/main/Orion.lua')))()

-- Services
local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")
local VirtualUser = game:GetService("VirtualUser")
local Stats = game:GetService("Stats")
local Camera = workspace.CurrentCamera

local LocalPlayer = Players.LocalPlayer

-- ===========================
-- ENHANCED WINDOW DESIGN
-- ===========================
local Window = OrionLib:MakeWindow({
    Name = "‚îÇsamuel.1 ‚îÇ„ÄÑEmergency Hamburg",
    SaveConfig = false,
    IntroText = "SamuelsBeste",
    IntroIcon = "rbxassetid://4483345998",
    Theme = "Dark"
})

-- ===========================
-- CREDITS TAB
-- ===========================
local CreditsTab = Window:MakeTab({ Name = "üòé‚îÇCredits" })
CreditsTab:AddParagraph("¬© 2025   samuel Scripts", "Premium Emergency Hamburg Script")
CreditsTab:AddButton({
    Name = "üìã Copy Discord Link",
    Callback = function()
        setclipboard("https://discord.gg/MNEv7h9yWU")
        OrionLib:MakeNotification({
            Name = "Discord",
            Content = "Link copied to clipboard!",
            Image = "rbxassetid://4483345998",
            Time = 3
        })
    end
})

-- ===========================
-- PLAYER TAB (ENHANCED)
-- ===========================
local PlayerTab = Window:MakeTab({ Name = "‚öô‚îÇPlayer" })
PlayerTab:AddSection({ Name = "Player Utilities" })

-- Enhanced Click to Delete
local destroyEnabled = false
local mouse = LocalPlayer:GetMouse()
PlayerTab:AddToggle({
    Name = "üîò Click to Delete",
    Default = false,
    Callback = function(v) 
        destroyEnabled = v 
        OrionLib:MakeNotification({
            Name = "Click Delete",
            Content = v and "Enabled - Click objects to delete" or "Disabled",
            Time = 2
        })
    end
})

mouse.Button1Down:Connect(function()
    if destroyEnabled and mouse.Target then
        mouse.Target:Destroy()
    end
end)

-- Enhanced Noclip
local noclipEnabled = false
local noclipConnection
PlayerTab:AddToggle({
    Name = "üîò Noclip",
    Default = false,
    Callback = function(v)
        noclipEnabled = v
        if v then
            noclipConnection = RunService.Stepped:Connect(function()
                if LocalPlayer.Character then
                    for _, part in ipairs(LocalPlayer.Character:GetDescendants()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = false
                        end
                    end
                end
            end)
        elseif noclipConnection then
            noclipConnection:Disconnect()
            noclipConnection = nil
        end
    end
})

-- ENHANCED PLAYER FLY
local flyEnabled = false
local flySpeed = 50
local flyConnection

local function updateFlight(delta)
    if not flyEnabled or not LocalPlayer.Character then return end
    
    local humanoidRootPart = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end
    
    local direction = Vector3.zero
    
    if UserInputService:IsKeyDown(Enum.KeyCode.W) then
        direction = direction + Camera.CFrame.LookVector
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.S) then
        direction = direction - Camera.CFrame.LookVector
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.A) then
        direction = direction - Camera.CFrame.RightVector
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.D) then
        direction = direction + Camera.CFrame.RightVector
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
        direction = direction + Vector3.new(0, 1, 0)
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
        direction = direction - Vector3.new(0, 1, 0)
    end
    
    if direction.Magnitude > 0 then
        direction = direction.Unit * flySpeed
    end
    
    -- Apply smooth movement
    humanoidRootPart.Velocity = direction
    humanoidRootPart.CFrame = CFrame.lookAt(
        humanoidRootPart.Position,
        humanoidRootPart.Position + Camera.CFrame.LookVector
    )
end

PlayerTab:AddToggle({
    Name = "üîò Player Fly (Enhanced)",
    Default = false,
    Callback = function(v)
        flyEnabled = v
        if v then
            flyConnection = RunService.RenderStepped:Connect(updateFlight)
            OrionLib:MakeNotification({
                Name = "Flight Mode",
                Content = "Flight Enabled - Use WASD, Space/Shift",
                Time = 3
            })
        elseif flyConnection then
            flyConnection:Disconnect()
            flyConnection = nil
        end
    end
})

PlayerTab:AddSlider({
    Name = "üîò Fly Speed",
    Min = 10,
    Max = 200,
    Default = 50,
    Color = Color3.fromRGB(0, 170, 255),
    Increment = 5,
    ValueName = "Speed",
    Callback = function(v) flySpeed = v end
})

-- Enhanced Anti-Fall/Damage
local antiFallEnabled = false
local antiFallConnection
PlayerTab:AddToggle({
    Name = "üîò Anti-Fall/Damage",
    Default = false,
    Callback = function(v)
        antiFallEnabled = v
        if v then
            antiFallConnection = RunService.Heartbeat:Connect(function()
                if LocalPlayer.Character then
                    local humanoid = LocalPlayer.Character:FindFirstChild("Humanoid")
                    local root = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                    
                    if humanoid and root then
                        -- Prevent falling damage
                        if root.Velocity.Y < -50 then
                            root.Velocity = Vector3.new(root.Velocity.X, -10, root.Velocity.Z)
                        end
                        
                        -- Auto heal if low health
                        if humanoid.Health < 30 then
                            humanoid.Health = humanoid.MaxHealth
                        end
                    end
                end
            end)
        elseif antiFallConnection then
            antiFallConnection:Disconnect()
            antiFallConnection = nil
        end
    end
})

-- Enhanced Anti-Taser
local antiTaserEnabled = false
PlayerTab:AddToggle({
    Name = "üîò Anti-Taser",
    Default = false,
    Callback = function(v)
        antiTaserEnabled = v
        if v then
            LocalPlayer.CharacterAdded:Connect(function(char)
                task.wait(0.5)
                local humanoid = char:WaitForChild("Humanoid")
                humanoid:GetPropertyChangedSignal("PlatformStand"):Connect(function()
                    if humanoid.PlatformStand then
                        humanoid.PlatformStand = false
                    end
                end)
            end)
        end
    end
})

-- Auto Taser (Enhanced)
local autoTaserEnabled = false
local taserCooldown = 0.5
local lastTaserTime = 0

PlayerTab:AddToggle({
    Name = "üîò Auto Taser",
    Default = false,
    Callback = function(v)
        autoTaserEnabled = v
        if v then
            OrionLib:MakeNotification({
                Name = "Auto Taser",
                Content = "Enabled - Auto-tasing nearest enemies",
                Time = 3
            })
        end
    end
})

-- Auto Taser Loop
spawn(function()
    while true do
        if autoTaserEnabled and tick() - lastTaserTime >= taserCooldown then
            pcall(function()
                local character = LocalPlayer.Character
                if character then
                    local taser = character:FindFirstChild("Taser")
                    if taser then
                        -- Find nearest enemy
                        local nearestPlayer = nil
                        local nearestDistance = math.huge
                        
                        for _, player in ipairs(Players:GetPlayers()) do
                            if player ~= LocalPlayer and player.Character then
                                local targetRoot = player.Character:FindFirstChild("HumanoidRootPart")
                                local charRoot = character:FindFirstChild("HumanoidRootPart")
                                
                                if targetRoot and charRoot then
                                    local distance = (targetRoot.Position - charRoot.Position).Magnitude
                                    if distance < nearestDistance and distance < 50 then
                                        nearestDistance = distance
                                        nearestPlayer = player
                                    end
                                end
                            end
                        end
                        
                        if nearestPlayer then
                            -- Fire taser
                            local remote = ReplicatedStorage:FindFirstChild("Bnl")
                            if remote then
                                local taserRemote = remote:FindFirstChild("c6011f40-2809-4686-a297-33283dd11715")
                                if taserRemote then
                                    taserRemote:FireServer(taser, nearestPlayer.Character.HumanoidRootPart.Position)
                                    lastTaserTime = tick()
                                end
                            end
                        end
                    end
                end
            end)
        end
        task.wait(0.1)
    end
end)

-- Jump Power (Enhanced)
local jumpPower = 50
PlayerTab:AddSlider({
    Name = "üîò Jump Power",
    Min = 0,
    Max = 500,
    Default = 50,
    Color = Color3.fromRGB(255, 200, 0),
    Increment = 10,
    ValueName = "Power",
    Callback = function(v) jumpPower = v end
})

LocalPlayer.CharacterAdded:Connect(function(char)
    char:WaitForChild("Humanoid").Jumping:Connect(function()
        if jumpPower > 0 then
            local root = char:FindFirstChild("HumanoidRootPart")
            if root then
                root.Velocity = Vector3.new(root.Velocity.X, jumpPower, root.Velocity.Z)
            end
        end
    end)
end)

-- Utility Buttons
PlayerTab:AddSection({ Name = "Utilities" })
PlayerTab:AddButton({
    Name = "üîò Jump from Vehicle",
    Callback = function()
        local char = LocalPlayer.Character
        if char then
            local humanoid = char:FindFirstChild("Humanoid")
            if humanoid then
                humanoid.Sit = false
                humanoid.Jump = true
            end
        end
    end
})

PlayerTab:AddButton({
    Name = "üîò Reset Character",
    Callback = function()
        local char = LocalPlayer.Character
        if char then
            char:BreakJoints()
        end
    end
})

-- ===========================
-- ENHANCED CAR FLY TAB
-- ===========================
local CarTab = Window:MakeTab({ Name = "üõ∫‚îÇCar Fly" })
CarTab:AddSection({ Name = "Car Flight" })

-- Enhanced Car Fly
local carFlyEnabled = false
local carFlySpeed = 100
local carFlyConnection

local function updateCarFlight()
    if not carFlyEnabled then return end
    
    local character = LocalPlayer.Character
    if not character then return end
    
    local humanoid = character:FindFirstChild("Humanoid")
    if not humanoid then return end
    
    local seat = humanoid.SeatPart
    if not seat or seat.Name ~= "DriveSeat" then return end
    
    local vehicle = seat.Parent
    if not vehicle then return end
    
    if not vehicle.PrimaryPart then
        vehicle.PrimaryPart = seat
    end
    
    -- Calculate movement direction
    local direction = Vector3.zero
    local camera = workspace.CurrentCamera
    
    if UserInputService:IsKeyDown(Enum.KeyCode.W) then
        direction = direction + camera.CFrame.LookVector
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.S) then
        direction = direction - camera.CFrame.LookVector
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.A) then
        direction = direction - camera.CFrame.RightVector
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.D) then
        direction = direction + camera.CFrame.RightVector
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.E) then
        direction = direction + Vector3.new(0, 1, 0)
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.Q) then
        direction = direction - Vector3.new(0, 1, 0)
    end
    
    if direction.Magnitude > 0 then
        direction = direction.Unit * carFlySpeed
        
        -- Apply movement
        vehicle:PivotTo(vehicle:GetPivot() + direction * 0.05)
        
        -- Reset velocities for smooth flight
        for _, part in ipairs(vehicle:GetDescendants()) do
            if part:IsA("BasePart") then
                part.Velocity = Vector3.zero
                part.RotVelocity = Vector3.zero
            end
        end
    end
end

CarTab:AddToggle({
    Name = "üü¢ Car Fly",
    Default = false,
    Callback = function(v)
        carFlyEnabled = v
        if v then
            carFlyConnection = RunService.RenderStepped:Connect(updateCarFlight)
            OrionLib:MakeNotification({
                Name = "Car Fly",
                Content = "Enabled - Use WASD to fly, Q/E for altitude",
                Time = 3
            })
        elseif carFlyConnection then
            carFlyConnection:Disconnect()
            carFlyConnection = nil
        end
    end
})

CarTab:AddSlider({
    Name = "üü¢ Car Fly Speed",
    Min = 10,
    Max = 500,
    Default = 100,
    Color = Color3.fromRGB(0, 255, 100),
    Increment = 10,
    ValueName = "Speed",
    Callback = function(v) carFlySpeed = v end
})

-- Car Mods
CarTab:AddSection({ Name = "Car Modifications" })

local rainbowCarEnabled = false
CarTab:AddToggle({
    Name = "üü¢ Rainbow Car",
    Default = false,
    Callback = function(v)
        rainbowCarEnabled = v
        if v then
            spawn(function()
                while rainbowCarEnabled do
                    local vehicle = Workspace.Vehicles:FindFirstChild(LocalPlayer.Name)
                    if vehicle then
                        local hue = tick() % 5 / 5
                        local color = Color3.fromHSV(hue, 1, 1)
                        
                        for _, part in ipairs(vehicle:GetDescendants()) do
                            if part:IsA("BasePart") then
                                part.Color = color
                            end
                        end
                    end
                    task.wait(0.1)
                end
            end)
        end
    end
})

CarTab:AddButton({
    Name = "üü¢ God Mode Car",
    Callback = function()
        local vehicle = Workspace.Vehicles:FindFirstChild(LocalPlayer.Name)
        if vehicle then
            vehicle:SetAttribute("CurrentHealth", math.huge)
            vehicle:SetAttribute("IsOn", true)
            OrionLib:MakeNotification({
                Name = "Car God Mode",
                Content = "God mode activated for your vehicle",
                Time = 3
            })
        end
    end
})

CarTab:AddButton({
    Name = "üü¢ Infinite Fuel",
    Callback = function()
        local vehicle = Workspace.Vehicles:FindFirstChild(LocalPlayer.Name)
        if vehicle then
            vehicle:SetAttribute("CurrentFuel", math.huge)
            OrionLib:MakeNotification({
                Name = "Infinite Fuel",
                Content = "Fuel set to infinite",
                Time = 3
            })
        end
    end
})

-- ===========================
-- ENHANCED TELEPORT TAB
-- ===========================
local TeleportTab = Window:MakeTab({ Name = "üåÄ‚îÇTeleport" })
TeleportTab:AddSection({ Name = "Instant Teleports" })

-- INSTANT Teleport function (no tweening)
local function instantTeleport(cframe)
    local character = LocalPlayer.Character
    if not character then return end
    
    local vehicle = Workspace.Vehicles:FindFirstChild(LocalPlayer.Name)
    
    if vehicle then
        -- Teleport vehicle instantly
        if not vehicle.PrimaryPart then
            local driveSeat = vehicle:FindFirstChild("DriveSeat")
            if driveSeat then
                vehicle.PrimaryPart = driveSeat
            end
        end
        
        if vehicle.PrimaryPart then
            vehicle:PivotTo(cframe)
            
            -- Put player in vehicle
            local humanoid = character:FindFirstChild("Humanoid")
            local driveSeat = vehicle:FindFirstChild("DriveSeat")
            if humanoid and driveSeat then
                driveSeat:Sit(humanoid)
            end
        end
    else
        -- Teleport player only
        local root = character:FindFirstChild("HumanoidRootPart")
        if root then
            root.CFrame = cframe
        end
    end
end

-- Locations Database
local locations = {
    -- Police & Emergency
    ["Police Station"] = CFrame.new(-1658.072, 5.63, 2737.27),
    ["Prison Entrance"] = CFrame.new(-615.58, 5.29, 2862.237),
    ["Prison Inside"] = CFrame.new(-572.106, 6.382, 3061.374),
    ["Hospital"] = CFrame.new(-278.834, 7.745, 1085.797),
    ["Fire Station"] = CFrame.new(-1025.361, 4.5, 3899.155),
    
    -- Robbery Locations
    ["Bank"] = CFrame.new(-1198.693, 7.978, 3161.448),
    ["Jewellery Store"] = CFrame.new(-407.536, 21.95, 3516.854),
    ["Club"] = CFrame.new(-1856.962, 5.706, 2990.518),
    
    -- Shops
    ["Tuning Garage"] = CFrame.new(-1438.654, 5.63, 118.45),
    ["Dealership"] = CFrame.new(-1415.699, 4.552, 940.526),
    ["Truck Company"] = CFrame.new(704.451, 4.229, 1479.927),
    ["Bus Company"] = CFrame.new(-1682.297, 8.779, -1273.078),
    
    -- Fuel Stations
    ["Gas Station 1"] = CFrame.new(-1560.674, 3.944, 3813.656),
    ["Gas Station 2"] = CFrame.new(-824.447, 4.182, 1512.941),
    ["Gas Station 3"] = CFrame.new(-27.464, 5.245, -749.413),
    
    -- Other
    ["Smuggler"] = CFrame.new(796.557, -18.67, -1526.379),
    ["Container Ship"] = CFrame.new(1191.836, 29.55, 2140.703),
    ["Clothing Store"] = CFrame.new(440.4, 5.52, -1438.111),
}

-- Quick Teleport Buttons
TeleportTab:AddButton({
    Name = "üåÄ Teleport to Bank (Robbery)",
    Callback = function()
        instantTeleport(locations["Bank"])
        OrionLib:MakeNotification({
            Name = "Teleport",
            Content = "Teleported to Bank",
            Time = 2
        })
    end
})

TeleportTab:AddButton({
    Name = "üåÄ Teleport to Police Station",
    Callback = function()
        instantTeleport(locations["Police Station"])
        OrionLib:MakeNotification({
            Name = "Teleport",
            Content = "Teleported to Police Station",
            Time = 2
        })
    end
})

TeleportTab:AddButton({
    Name = "üåÄ Teleport to Hospital",
    Callback = function()
        instantTeleport(locations["Hospital"])
        OrionLib:MakeNotification({
            Name = "Teleport",
            Content = "Teleported to Hospital",
            Time = 2
        })
    end
})

-- Location Dropdown
local locationList = {}
for name in pairs(locations) do
    table.insert(locationList, name)
end
table.sort(locationList)

TeleportTab:AddDropdown({
    Name = "üåÄ Select Location",
    Default = "Bank",
    Options = locationList,
    Callback = function(selected)
        if locations[selected] then
            instantTeleport(locations[selected])
            OrionLib:MakeNotification({
                Name = "Teleport",
                Content = "Teleported to " .. selected,
                Time = 2
            })
        end
    end
})

-- Nearest Dealer Teleport
TeleportTab:AddButton({
    Name = "üåÄ Teleport to Nearest Dealer",
    Callback = function()
        local dealers = Workspace:FindFirstChild("Dealers")
        if dealers then
            local nearest = nil
            local nearestDist = math.huge
            local charPos = LocalPlayer.Character.HumanoidRootPart.Position
            
            for _, dealer in ipairs(dealers:GetChildren()) do
                if dealer:FindFirstChild("Head") then
                    local dist = (dealer.Head.Position - charPos).Magnitude
                    if dist < nearestDist then
                        nearestDist = dist
                        nearest = dealer
                    end
                end
            end
            
            if nearest then
                instantTeleport(nearest.Head.CFrame + Vector3.new(0, 5, 0))
            end
        end
    end
})

-- ===========================
-- ENHANCED ESP TAB
-- ===========================
local ESPTab = Window:MakeTab({ Name = "üëÅÔ∏è‚îÇESP" })
ESPTab:AddSection({ Name = "ESP Settings" })

-- Enhanced ESP System
local espEnabled = false
local espBoxes = {}
local espHealthBars = {}
local espNames = {}

local function createESP(player)
    if player == LocalPlayer then return end
    
    -- Create ESP Box
    local box = Drawing.new("Square")
    box.Visible = false
    box.Thickness = 2
    box.Color = Color3.new(1, 0, 0)
    box.Filled = false
    
    -- Create Health Bar
    local healthBar = Drawing.new("Square")
    healthBar.Visible = false
    healthBar.Thickness = 1
    healthBar.Color = Color3.new(0, 1, 0)
    healthBar.Filled = true
    
    -- Create Name
    local nameLabel = Drawing.new("Text")
    nameLabel.Visible = false
    nameLabel.Color = Color3.new(1, 1, 1)
    nameLabel.Size = 14
    nameLabel.Center = true
    nameLabel.Outline = true
    nameLabel.Text = player.Name
    
    espBoxes[player] = box
    espHealthBars[player] = healthBar
    espNames[player] = nameLabel
end

local function updateESP()
    for player, box in pairs(espBoxes) do
        if player.Character and player.Character:FindFirstChild("Humanoid") and player.Character:FindFirstChild("HumanoidRootPart") then
            local rootPart = player.Character.HumanoidRootPart
            local humanoid = player.Character.Humanoid
            local screenPos, onScreen = Camera:WorldToViewportPoint(rootPart.Position)
            
            if onScreen and espEnabled then
                -- Update Box
                local boxSize = Vector2.new(30, 50)
                box.Size = boxSize
                box.Position = Vector2.new(screenPos.X - boxSize.X/2, screenPos.Y - boxSize.Y/2)
                box.Visible = true
                
                -- Update Health Bar
                local healthPercent = humanoid.Health / humanoid.MaxHealth
                local healthBarHeight = 50 * healthPercent
                healthBar = espHealthBars[player]
                healthBar.Size = Vector2.new(4, healthBarHeight)
                healthBar.Position = Vector2.new(screenPos.X - 25, screenPos.Y + 25 - healthBarHeight)
                healthBar.Color = Color3.fromHSV(healthPercent * 0.3, 1, 1)
                healthBar.Visible = true
                
                -- Update Name
                nameLabel = espNames[player]
                nameLabel.Position = Vector2.new(screenPos.X, screenPos.Y - 30)
                nameLabel.Visible = true
            else
                box.Visible = false
                if espHealthBars[player] then espHealthBars[player].Visible = false end
                if espNames[player] then espNames[player].Visible = false end
            end
        else
            box.Visible = false
            if espHealthBars[player] then espHealthBars[player].Visible = false end
            if espNames[player] then espNames[player].Visible = false end
        end
    end
end

-- Initialize ESP for existing players
for _, player in ipairs(Players:GetPlayers()) do
    createESP(player)
end

Players.PlayerAdded:Connect(function(player)
    createESP(player)
end)

Players.PlayerRemoving:Connect(function(player)
    if espBoxes[player] then espBoxes[player]:Remove() end
    if espHealthBars[player] then espHealthBars[player]:Remove() end
    if espNames[player] then espNames[player]:Remove() end
    espBoxes[player] = nil
    espHealthBars[player] = nil
    espNames[player] = nil
end)

ESPTab:AddToggle({
    Name = "üëÅÔ∏è Enable ESP",
    Default = false,
    Callback = function(v)
        espEnabled = v
        if v then
            RunService:BindToRenderStep("ESPUpdate", Enum.RenderPriority.First.Value + 1, updateESP)
        else
            RunService:UnbindFromRenderStep("ESPUpdate")
            for _, box in pairs(espBoxes) do box.Visible = false end
            for _, bar in pairs(espHealthBars) do bar.Visible = false end
            for _, name in pairs(espNames) do name.Visible = false end
        end
    end
})

-- Wanted ESP
local wantedESPEnabled = false
ESPTab:AddToggle({
    Name = "üëÅÔ∏è Wanted ESP",
    Default = false,
    Callback = function(v)
        wantedESPEnabled = v
    end
})

-- Crime ESP
local crimeESPEnabled = false
ESPTab:AddToggle({
    Name = "üëÅÔ∏è Crime ESP",
    Default = false,
    Callback = function(v)
        crimeESPEnabled = v
    end
})

-- ===========================
-- ENHANCED AIMBOT TAB
-- ===========================
local AimbotTab = Window:MakeTab({ Name = "üî¥‚îÇAimbot" })
AimbotTab:AddSection({ Name = "Aimbot Settings" })

-- Enhanced Aimbot with Wall Penetration
local aimbotEnabled = false
local aimbotKey = Enum.KeyCode.V
local aimbotFOV = 100
local aimbotSmoothness = 0.2
local aimbotPart = "Head"
local wallPenetration = true

-- Aimbot FOV Circle
local fovCircle = Drawing.new("Circle")
fovCircle.Visible = false
fovCircle.Radius = aimbotFOV
fovCircle.Thickness = 2
fovCircle.Color = Color3.new(1, 0, 0)
fovCircle.Position = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)

local function findTarget()
    local nearestPlayer = nil
    local nearestDistance = aimbotFOV
    
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local targetPart = player.Character:FindFirstChild(aimbotPart)
            if targetPart then
                local screenPos, onScreen = Camera:WorldToViewportPoint(targetPart.Position)
                
                if onScreen or wallPenetration then
                    local mousePos = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)
                    local targetPos = Vector2.new(screenPos.X, screenPos.Y)
                    local distance = (mousePos - targetPos).Magnitude
                    
                    if distance < nearestDistance then
                        nearestDistance = distance
                        nearestPlayer = player
                    end
                end
            end
        end
    end
    
    return nearestPlayer
end

local function aimAtTarget()
    if not aimbotEnabled then return end
    
    local target = findTarget()
    if target and target.Character then
        local targetPart = target.Character:FindFirstChild(aimbotPart)
        if targetPart then
            local targetPosition = targetPart.Position
            
            -- Add prediction for moving targets
            if targetPart.Velocity.Magnitude > 0 then
                targetPosition = targetPosition + targetPart.Velocity * 0.1
            end
            
            local currentCFrame = Camera.CFrame
            local targetCFrame = CFrame.new(Camera.CFrame.Position, targetPosition)
            
            -- Smooth aiming
            Camera.CFrame = currentCFrame:Lerp(targetCFrame, aimbotSmoothness)
        end
    end
end

UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == aimbotKey then
        aimbotEnabled = true
        fovCircle.Visible = true
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.KeyCode == aimbotKey then
        aimbotEnabled = false
        fovCircle.Visible = false
    end
end)

RunService.RenderStepped:Connect(function()
    fovCircle.Position = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)
    if aimbotEnabled then
        aimAtTarget()
    end
end)

AimbotTab:AddToggle({
    Name = "üî¥ Enable Aimbot",
    Default = false,
    Callback = function(v)
        aimbotEnabled = v
        fovCircle.Visible = v
    end
})

AimbotTab:AddBind({
    Name = "üî¥ Aimbot Keybind",
    Default = Enum.KeyCode.V,
    Hold = false,
    Callback = function()
        aimbotEnabled = not aimbotEnabled
        fovCircle.Visible = aimbotEnabled
    end
})

AimbotTab:AddDropdown({
    Name = "üî¥ Aim Part",
    Default = "Head",
    Options = {"Head", "Torso", "HumanoidRootPart"},
    Callback = function(v)
        aimbotPart = v
    end
})

AimbotTab:AddToggle({
    Name = "üî¥ Wall Penetration",
    Default = true,
    Callback = function(v)
        wallPenetration = v
    end
})

AimbotTab:AddSlider({
    Name = "üî¥ Aimbot FOV",
    Min = 10,
    Max = 500,
    Default = 100,
    Color = Color3.fromRGB(255, 0, 0),
    Increment = 10,
    ValueName = "FOV",
    Callback = function(v)
        aimbotFOV = v
        fovCircle.Radius = v
    end
})

AimbotTab:AddSlider({
    Name = "üî¥ Smoothness",
    Min = 0,
    Max = 1,
    Default = 0.2,
    Color = Color3.fromRGB(255, 100, 100),
    Increment = 0.05,
    ValueName = "",
    Callback = function(v)
        aimbotSmoothness = v
    end
})

-- ===========================
-- POLICE TAB
-- ===========================
local PoliceTab = Window:MakeTab({ Name = "üëÆ‚îÇPolice" })
PoliceTab:AddSection({ Name = "Police Features" })

-- Radar Farm
local radarFarmEnabled = false
PoliceTab:AddToggle({
    Name = "üì° Radar Farm",
    Default = false,
    Callback = function(v)
        radarFarmEnabled = v
        if v then
            OrionLib:MakeNotification({
                Name = "Radar Farm",
                Content = "Started farming speeders",
                Time = 3
            })
        end
    end
})

-- Radar Farm Loop
spawn(function()
    while true do
        if radarFarmEnabled then
            pcall(function()
                local character = LocalPlayer.Character
                if character then
                    local radarGun = character:FindFirstChild("Radar Gun")
                    if radarGun then
                        for _, vehicle in ipairs(Workspace.Vehicles:GetChildren()) do
                            if vehicle:FindFirstChild("DriveSeat") then
                                local remote = ReplicatedStorage:FindFirstChild("Bnl")
                                if remote then
                                    local radarRemote = remote:FindFirstChild("bbb7c252-304d-4582-b2a0-89eb9d3a0855")
                                    if radarRemote then
                                        radarRemote:FireServer(radarGun, vehicle.DriveSeat.Position, Vector3.new(0, 0, 0))
                                    end
                                end
                            end
                        end
                    end
                end
            end)
        end
        task.wait(1)
    end
end)

-- Anti-AFK
local antiAFKEnabled = false
PoliceTab:AddToggle({
    Name = "‚è∞ Anti-AFK",
    Default = false,
    Callback = function(v)
        antiAFKEnabled = v
        if v then
            VirtualUser:CaptureController()
            VirtualUser:ClickButton2(Vector2.new())
            OrionLib:MakeNotification({
                Name = "Anti-AFK",
                Content = "Enabled - You won't be kicked for AFK",
                Time = 3
            })
        end
    end
})

-- Police Teleports
PoliceTab:AddButton({
    Name = "üëÆ Teleport to Police Station",
    Callback = function()
        instantTeleport(CFrame.new(-1670.692, 5.99, 2771.11))
    end
})

PoliceTab:AddButton({
    Name = "üëÆ Teleport to Farming Spot",
    Callback = function()
        instantTeleport(CFrame.new(-1148.454, 9.49, 2805.56))
    end
})

-- ===========================
-- SELF REVIVE TAB
-- ===========================
local ReviveTab = Window:MakeTab({ Name = "üíú‚îÇSelf Revive" })
ReviveTab:AddParagraph("Auto Revive System", "Automatically heals you when low health")

local autoReviveEnabled = false
local reviveConnection

local function autoRevive()
    local character = LocalPlayer.Character
    if not character then return end
    
    local humanoid = character:FindFirstChild("Humanoid")
    if not humanoid then return end
    
    if humanoid.Health < 30 then
        -- Teleport to hospital
        local hospitalBed = Workspace:FindFirstChild("Buildings")
        if hospitalBed then
            hospitalBed = hospitalBed:FindFirstChild("Hospital")
            if hospitalBed then
                hospitalBed = hospitalBed:FindFirstChild("HospitalBed")
                if hospitalBed then
                    -- Teleport to hospital
                    instantTeleport(hospitalBed.CFrame + Vector3.new(0, 5, 0))
                    
                    -- Wait and heal
                    task.wait(1)
                    humanoid.Health = humanoid.MaxHealth
                    
                    OrionLib:MakeNotification({
                        Name = "Auto Revive",
                        Content = "You have been healed!",
                        Time = 3
                    })
                end
            end
        end
    end
end

ReviveTab:AddToggle({
    Name = "üíú Enable Auto Revive",
    Default = false,
    Callback = function(v)
        autoReviveEnabled = v
        if v then
            reviveConnection = RunService.Heartbeat:Connect(function()
                autoRevive()
            end)
            OrionLib:MakeNotification({
                Name = "Auto Revive",
                Content = "Enabled - You will auto-revive when low health",
                Time = 3
            })
        elseif reviveConnection then
            reviveConnection:Disconnect()
            reviveConnection = nil
        end
    end
})

ReviveTab:AddButton({
    Name = "üíú Force Revive Now",
    Callback = function()
        local character = LocalPlayer.Character
        if character then
            local humanoid = character:FindFirstChild("Humanoid")
            if humanoid then
                humanoid.Health = humanoid.MaxHealth
                OrionLib:MakeNotification({
                    Name = "Revive",
                    Content = "You have been revived!",
                    Time = 3
                })
            end
        end
    end
})

-- ===========================
-- INITIALIZE GUI
-- ===========================
OrionLib:Init()

-- Cleanup on script end
game:GetService("UserInputService").WindowFocused:Connect(function()
    -- Keep scripts running
end)

game:GetService("UserInputService").WindowFocusReleased:Connect(function()
    -- Optional: Pause heavy operations when tabbed out
end)
